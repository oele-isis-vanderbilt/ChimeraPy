
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>Introductionary Tutorial &#8212; chimerapy 0.0.1 documentation</title>
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../_static/alabaster.css" />
    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="API documentation" href="../api/index.html" />
    <link rel="prev" title="Basics" href="basics.html" />
   
  <link rel="stylesheet" href="../_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <section id="introductionary-tutorial">
<h1>Introductionary Tutorial<a class="headerlink" href="#introductionary-tutorial" title="Permalink to this headline">¶</a></h1>
<p>It is recommend that you read the <a class="reference internal" href="basics.html"><span class="doc std std-doc">Basics</span></a> first — as it
elaborates how each component of the library collaborate and
communicate. Below we provide a simple example. Note that defining a
pipeline and the data streams is heavily dependent on your data, sensors,
and intended analysis.</p>
<p>The example data can be found in this <a class="reference external" href="https://drive.google.com/drive/folders/1Y1pSOtbvMGgKIuJunuuAx-yzYAFaOWGz?usp=sharing">public Google Drive folder</a>.
Then perform the following instructions to setup the data.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span>unzip example_use_case.zip
mkdir data data/output_data
mv example_use_case data data/example_use_case
tree
.
├── data
│   ├── example_use_case
│   │   ├── test.csv
│   │   └── test_video1.mp4
│   └── output_data
│       └── ...
└── main.py
</pre></div>
</div>
<p>All of the code presented below will be placed in <code class="docutils literal notranslate"><span class="pre">main.py</span></code>.</p>
<section id="the-setup">
<h2>The Setup<a class="headerlink" href="#the-setup" title="Permalink to this headline">¶</a></h2>
<p>For any pipeline project, is recommend that you define a set of
components early on. First, let’s start with the imports and constants.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">chimerapy</span> <span class="k">as</span> <span class="nn">cp</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">pathlib</span>

<span class="n">RAW_DATA_DIR</span> <span class="o">=</span> <span class="n">pathlib</span><span class="o">.</span><span class="n">Path</span><span class="o">.</span><span class="n">cwd</span><span class="p">()</span> <span class="o">/</span> <span class="s1">&#39;data&#39;</span>
<span class="n">OUTPUT_DIR</span> <span class="o">=</span> <span class="n">pathlib</span><span class="o">.</span>
</pre></div>
</div>
<p>The data streams used in this tutorial include one video and one
tabular data streams. You can have more or less combinations of
data streams (only video and tabular data streams supported right now).</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span>
<span class="c1"># Loading the data</span>
<span class="n">csv_data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">RAW_DATA_DIR</span><span class="o">/</span><span class="s2">&quot;example_use_case&quot;</span><span class="o">/</span><span class="s2">&quot;test.csv&quot;</span><span class="p">)</span>
<span class="n">csv_data</span><span class="p">[</span><span class="s1">&#39;_time_&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_timedelta</span><span class="p">(</span><span class="n">csv_data</span><span class="p">[</span><span class="s1">&#39;time&#39;</span><span class="p">],</span> <span class="n">unit</span><span class="o">=</span><span class="s2">&quot;s&quot;</span><span class="p">)</span>

<span class="c1"># Create each type of data stream</span>
<span class="bp">self</span><span class="o">.</span><span class="n">tabular_ds</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">TabularDataStream</span><span class="p">(</span>
    <span class="n">name</span><span class="o">=</span><span class="s2">&quot;test_tabular&quot;</span><span class="p">,</span>
    <span class="n">data</span><span class="o">=</span><span class="n">csv_data</span><span class="p">,</span>
    <span class="n">time_column</span><span class="o">=</span><span class="s2">&quot;_time_&quot;</span>
<span class="p">)</span>
<span class="bp">self</span><span class="o">.</span><span class="n">video_ds</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">VideoDataStream</span><span class="p">(</span>
    <span class="n">name</span><span class="o">=</span><span class="s2">&quot;test_video&quot;</span><span class="p">,</span>
    <span class="n">start_time</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">Timedelta</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span>
    <span class="n">video_path</span><span class="o">=</span><span class="n">RAW_DATA_DIR</span><span class="o">/</span><span class="s2">&quot;example_use_case&quot;</span><span class="o">/</span><span class="s2">&quot;test_video1.mp4&quot;</span><span class="p">,</span>
    <span class="n">fps</span><span class="o">=</span><span class="mi">30</span>
<span class="p">)</span>

</pre></div>
</div>
<p>After that, it is common to delete the generated logged data if
rerunning the pipeline (as you debugging during your development).
Another approach (that is safer) is to name the sessions with a
timestamp. However, beware that output video files can have a large
memory footprint.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span>
<span class="c1"># Clearing out the previous session</span>
<span class="n">experiment_name</span> <span class="o">=</span> <span class="s1">&#39;P01&#39;</span>
<span class="n">experiment_dir</span> <span class="o">=</span> <span class="n">OUTPUT_DIR</span> <span class="o">/</span> <span class="n">experiment_name</span>
<span class="k">if</span> <span class="n">experiment_dir</span><span class="o">.</span><span class="n">exists</span><span class="p">():</span>
    <span class="n">shutil</span><span class="o">.</span><span class="n">rmtree</span><span class="p">(</span><span class="n">experiment_dir</span><span class="p">)</span>

</pre></div>
</div>
<p>Finally, it is the step of defining a pipeline. Below is a very
minimal pipeline that purely logs data.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span>
<span class="k">class</span> <span class="nc">TestExamplePipeline</span><span class="p">(</span><span class="n">cp</span><span class="o">.</span><span class="n">Pipeline</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">step</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data_samples</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">]]):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">session</span><span class="o">.</span><span class="n">add_tabular</span><span class="p">(</span><span class="s1">&#39;test_tabular&#39;</span><span class="p">,</span> <span class="n">data_samples</span><span class="p">[</span><span class="s1">&#39;test_tabular&#39;</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">session</span><span class="o">.</span><span class="n">add_video</span><span class="p">(</span><span class="s1">&#39;test_video&#39;</span><span class="p">,</span> <span class="n">data_samples</span><span class="p">[</span><span class="s1">&#39;test_video&#39;</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">session</span><span class="o">.</span><span class="n">add_images</span><span class="p">(</span><span class="s1">&#39;test_images&#39;</span><span class="p">,</span> <span class="n">data_samples</span><span class="p">[</span><span class="s1">&#39;test_video&#39;</span><span class="p">])</span>

<span class="c1"># Use a test pipeline</span>
<span class="bp">self</span><span class="o">.</span><span class="n">individual_pipeline</span> <span class="o">=</span> <span class="n">TestExamplePipeline</span><span class="p">()</span>

</pre></div>
</div>
<p>Once we have defined and constructed these individual components, we can
feed these to the runners to execute the pipeline.</p>
</section>
<section id="executing-the-pipeline-through-the-runners">
<h2>Executing the Pipeline through the Runners<a class="headerlink" href="#executing-the-pipeline-through-the-runners" title="Permalink to this headline">¶</a></h2>
<p>There are two main runner types: <code class="docutils literal notranslate"><span class="pre">SingleRunner</span></code> and <code class="docutils literal notranslate"><span class="pre">GroupRunner</span></code>.
As mentioned in the <a class="reference internal" href="basics.html"><span class="doc std std-doc">Basics</span></a>, these two runners have
different intended purposes.</p>
<p>Note: the runners create a directory (logdir / name) to store all the
logged data. The runners take the typical data streams and pipelines,
but also provide additional customization. More information about each
input parameter can be found in the <span class="xref myst">API documentation</span>.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Load construct the first runner</span>
<span class="bp">self</span><span class="o">.</span><span class="n">runner</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">SingleRunner</span><span class="p">(</span>
    <span class="n">logdir</span><span class="o">=</span><span class="n">OUTPUT_DIR</span><span class="p">,</span>
    <span class="n">name</span><span class="o">=</span><span class="s1">&#39;P01&#39;</span><span class="p">,</span>
    <span class="n">data_streams</span><span class="o">=</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">tabular_ds</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">video_ds</span><span class="p">],</span>
    <span class="n">pipe</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">individual_pipeline</span><span class="p">,</span>
    <span class="n">time_window</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">Timedelta</span><span class="p">(</span><span class="n">seconds</span><span class="o">=</span><span class="mf">0.5</span><span class="p">),</span>
    <span class="n">run_solo</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">memory_limit</span><span class="o">=</span><span class="mf">0.8</span>
<span class="p">)</span>
</pre></div>
</div>
<p>After constructing the runner, nothing will happen. Only until you <code class="docutils literal notranslate"><span class="pre">run</span></code>
the runner will the loading, processing, and logging of data will start.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Run the runner with everything set</span>
<span class="bp">self</span><span class="o">.</span><span class="n">runner</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">verbose</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
<p>An important input parameter to <code class="docutils literal notranslate"><span class="pre">run</span></code> is <code class="docutils literal notranslate"><span class="pre">verbose</span></code>. If debugging
your pipeline, it is recommended to set <code class="docutils literal notranslate"><span class="pre">verbose</span></code> to <code class="docutils literal notranslate"><span class="pre">False</span></code>. Else,
settings <code class="docutils literal notranslate"><span class="pre">verbose</span></code> to <code class="docutils literal notranslate"><span class="pre">True</span></code> provides a nice TUI that displays
progress reports.</p>
<p><img alt="TUI" src="../_images/TUI_example.png" /></p>
</section>
<section id="viewing-with-chimeradash">
<h2>Viewing With ChimeraDash<a class="headerlink" href="#viewing-with-chimeradash" title="Permalink to this headline">¶</a></h2>
<p>After passing all data through the pipeline and finishing logging, we
can view all the log data through ChimeraDash. Below is the simple
usage:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>chimerapy --logdir output_data/P01
</pre></div>
</div>
<p>Below is a snapshot of the expected output:</p>
<p><img alt="ChimeraDashTutorial" src="../_images/ChimeraDashTutorial.png" /></p>
</section>
</section>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="../index.html">chimerapy</a></h1>








<h3>Navigation</h3>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../framework/index.html">Overview</a></li>
</ul>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../getting_started.html">Getting Started</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="index.html">Usage</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="basics.html">Basics</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">Introductionary Tutorial</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#the-setup">The Setup</a></li>
<li class="toctree-l3"><a class="reference internal" href="#executing-the-pipeline-through-the-runners">Executing the Pipeline through the Runners</a></li>
<li class="toctree-l3"><a class="reference internal" href="#viewing-with-chimeradash">Viewing With ChimeraDash</a></li>
</ul>
</li>
</ul>
</li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../api/index.html">API documentation</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../contributing/index.html">Contributing</a></li>
<li class="toctree-l1"><a class="reference internal" href="../authors.html">Authors</a></li>
</ul>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="../index.html">Documentation overview</a><ul>
  <li><a href="index.html">Usage</a><ul>
      <li>Previous: <a href="basics.html" title="previous chapter">Basics</a></li>
      <li>Next: <a href="../api/index.html" title="next chapter">API documentation</a></li>
  </ul></li>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>$('#searchbox').show(0);</script>








        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2022, Vanderbilt OELE Laboratory.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 4.5.0</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.12</a>
      
      |
      <a href="../_sources/usage/intro_tutorial.md.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>